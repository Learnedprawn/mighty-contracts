# Aderyn Analysis Report

This report was generated by [Aderyn](https://github.com/Cyfrin/aderyn), a static analysis tool built by [Cyfrin](https://cyfrin.io), a blockchain security company. This report is not a substitute for manual audit or security review. It should not be relied upon for any purpose other than to assist in the identification of potential security vulnerabilities.
# Table of Contents

- [Summary](#summary)
  - [Files Summary](#files-summary)
  - [Files Details](#files-details)
  - [Issue Summary](#issue-summary)
- [High Issues](#high-issues)
  - [H-1: `abi.encodePacked()` should not be used with dynamic types when passing the result to a hash function such as `keccak256()`](#h-1-abiencodepacked-should-not-be-used-with-dynamic-types-when-passing-the-result-to-a-hash-function-such-as-keccak256)
  - [H-2: Arbitrary `from` passed to `transferFrom` (or `safeTransferFrom`)](#h-2-arbitrary-from-passed-to-transferfrom-or-safetransferfrom)
  - [H-3: Unprotected initializer](#h-3-unprotected-initializer)
  - [H-4: Experimental ABI Encoder](#h-4-experimental-abi-encoder)
  - [H-5: Incorrect use of caret operator on a non hexadcimal constant](#h-5-incorrect-use-of-caret-operator-on-a-non-hexadcimal-constant)
  - [H-6: Yul block contains `return` function call.](#h-6-yul-block-contains-return-function-call)
  - [H-7: Functions send eth away from contract but performs no checks on any address.](#h-7-functions-send-eth-away-from-contract-but-performs-no-checks-on-any-address)
  - [H-8: Delegatecall made by the function without checks on any address.](#h-8-delegatecall-made-by-the-function-without-checks-on-any-address)
  - [H-9: Return value of the function call is not checked.](#h-9-return-value-of-the-function-call-is-not-checked)
  - [H-10: Contract locks Ether without a withdraw function.](#h-10-contract-locks-ether-without-a-withdraw-function)
- [Low Issues](#low-issues)
  - [L-1: Centralization Risk for trusted owners](#l-1-centralization-risk-for-trusted-owners)
  - [L-2: Unsafe ERC20 Operations should not be used](#l-2-unsafe-erc20-operations-should-not-be-used)
  - [L-3: Solidity pragma should be specific, not wide](#l-3-solidity-pragma-should-be-specific-not-wide)
  - [L-4: Missing checks for `address(0)` when assigning values to address state variables](#l-4-missing-checks-for-address0-when-assigning-values-to-address-state-variables)
  - [L-5: `public` functions not used internally could be marked `external`](#l-5-public-functions-not-used-internally-could-be-marked-external)
  - [L-6: Define and use `constant` variables instead of using literals](#l-6-define-and-use-constant-variables-instead-of-using-literals)
  - [L-7: Event is missing `indexed` fields](#l-7-event-is-missing-indexed-fields)
  - [L-8: Empty `require()` / `revert()` statements](#l-8-empty-require--revert-statements)
  - [L-9: The `nonReentrant` `modifier` should occur before all other modifiers](#l-9-the-nonreentrant-modifier-should-occur-before-all-other-modifiers)
  - [L-10: Modifiers invoked only once can be shoe-horned into the function](#l-10-modifiers-invoked-only-once-can-be-shoe-horned-into-the-function)
  - [L-11: Empty Block](#l-11-empty-block)
  - [L-12: Large literal values multiples of 10000 can be replaced with scientific notation](#l-12-large-literal-values-multiples-of-10000-can-be-replaced-with-scientific-notation)
  - [L-13: Internal functions called only once can be inlined](#l-13-internal-functions-called-only-once-can-be-inlined)
  - [L-14: Unused Custom Error](#l-14-unused-custom-error)
  - [L-15: Loop contains `require`/`revert` statements](#l-15-loop-contains-requirerevert-statements)
  - [L-16: Uninitialized local variables.](#l-16-uninitialized-local-variables)
  - [L-17: Dead Code](#l-17-dead-code)
  - [L-18: Loop condition contains `state_variable.length` that could be cached outside.](#l-18-loop-condition-contains-statevariablelength-that-could-be-cached-outside)
  - [L-19: Costly operations inside loops.](#l-19-costly-operations-inside-loops)
  - [L-20: Potentially missing inheritance for contract.](#l-20-potentially-missing-inheritance-for-contract)
  - [L-21: Unused Imports](#l-21-unused-imports)
  - [L-22: State variable changes but no event is emitted.](#l-22-state-variable-changes-but-no-event-is-emitted)
  - [L-23: State variable could be declared immutable](#l-23-state-variable-could-be-declared-immutable)


# Summary

## Files Summary

| Key | Value |
| --- | --- |
| .sol Files | 52 |
| Total nSLOC | 3207 |


## Files Details

| Filepath | nSLOC |
| --- | --- |
| contracts/AddressRegistry.sol | 16 |
| contracts/IndividualPosition.sol | 57 |
| contracts/MightyTimelockController.sol | 8 |
| contracts/PaymentsUpgradeable.sol | 41 |
| contracts/PrimaryPriceOracle.sol | 52 |
| contracts/VaultRegistry.sol | 27 |
| contracts/interfaces/IAddressRegistry.sol | 10 |
| contracts/interfaces/IExtraInterestBearingToken.sol | 11 |
| contracts/interfaces/ILendingPool.sol | 137 |
| contracts/interfaces/IPayments.sol | 4 |
| contracts/interfaces/IPositionValueCalculator.sol | 9 |
| contracts/interfaces/IPriceOracle.sol | 4 |
| contracts/interfaces/IShadowGaugeV3.sol | 61 |
| contracts/interfaces/IShadowNonfungiblePositionManager.sol | 71 |
| contracts/interfaces/IShadowRangePositionImpl.sol | 37 |
| contracts/interfaces/IShadowRangeVault.sol | 5 |
| contracts/interfaces/IShadowSwapRouter.sol | 42 |
| contracts/interfaces/IShadowV3Pool.sol | 19 |
| contracts/interfaces/IShadowX33.sol | 4 |
| contracts/interfaces/IStakingRewards.sol | 25 |
| contracts/interfaces/ISwapXNonfungiblePositionManager.sol | 117 |
| contracts/interfaces/ISwapXSwapRouter.sol | 40 |
| contracts/interfaces/ISwapXV3Pool.sol | 11 |
| contracts/interfaces/IVault.sol | 110 |
| contracts/interfaces/IVaultFactory.sol | 7 |
| contracts/interfaces/IWETH9.sol | 6 |
| contracts/lendingpool/ExtraInterestBearingToken.sol | 57 |
| contracts/lendingpool/LendingPool.sol | 416 |
| contracts/lendingpool/Payments.sol | 41 |
| contracts/lendingpool/StakingRewards.sol | 138 |
| contracts/libraries/Constants.sol | 8 |
| contracts/libraries/Precision.sol | 5 |
| contracts/libraries/TransferHelper.sol | 21 |
| contracts/libraries/helpers/AddressId.sol | 14 |
| contracts/libraries/helpers/Errors.sol | 46 |
| contracts/libraries/logic/ETokenDeployer.sol | 15 |
| contracts/libraries/logic/InterestRateUtils.sol | 60 |
| contracts/libraries/logic/ReserveKey.sol | 9 |
| contracts/libraries/logic/ReserveLogic.sol | 123 |
| contracts/libraries/logic/StakingRewardsDeployer.sol | 8 |
| contracts/libraries/types/DataTypes.sol | 44 |
| contracts/libraries/uniswap-v3/FixedPoint96.sol | 5 |
| contracts/libraries/uniswap-v3/FullMath.sol | 59 |
| contracts/libraries/uniswap-v3/LiquidityAmounts.sol | 77 |
| contracts/libraries/uniswap-v3/TickMath.sol | 175 |
| contracts/mock/MockTestBorrowableVault.sol | 19 |
| contracts/mock/MockWETH9.sol | 23 |
| contracts/shadow/ShadowPositionValueCalculator.sol | 23 |
| contracts/shadow/ShadowRangePositionImpl.sol | 381 |
| contracts/shadow/ShadowRangeVault.sol | 391 |
| contracts/swapx/SwapXPositionValueCalculator.sol | 22 |
| contracts/viewer/VaultPositionViewer.sol | 96 |
| **Total** | **3207** |


## Issue Summary

| Category | No. of Issues |
| --- | --- |
| High | 10 |
| Low | 23 |


# High Issues

## H-1: `abi.encodePacked()` should not be used with dynamic types when passing the result to a hash function such as `keccak256()`

Use `abi.encode()` instead which will pad items to 32 bytes, which will [prevent hash collisions](https://docs.soliditylang.org/en/v0.8.13/abi-spec.html#non-standard-packed-mode) (e.g. `abi.encodePacked(0x123,0x456)` => `0x123456` => `abi.encodePacked(0x1,0x23456)`, but `abi.encode(0x123,0x456)` => `0x0...1230...456`). Unless there is a compelling reason, `abi.encode` should be preferred. If there is only one argument to `abi.encodePacked()` it can often be cast to `bytes()` or `bytes32()` [instead](https://ethereum.stackexchange.com/questions/30912/how-to-compare-strings-in-solidity#answer-82739).
If all arguments are strings and or bytes, `bytes.concat()` should be used instead.

<details><summary>2 Found Instances</summary>


- Found in contracts/lendingpool/LendingPool.sol [Line: 74](contracts/lendingpool/LendingPool.sol#L74)

	```solidity
	        string memory name = string(abi.encodePacked(ERC20(asset).name(), "(MightyFi Interest Bearing Token)"));
	```

- Found in contracts/lendingpool/LendingPool.sol [Line: 75](contracts/lendingpool/LendingPool.sol#L75)

	```solidity
	        string memory symbol = string(abi.encodePacked("m", ERC20(asset).symbol()));
	```

</details>



## H-2: Arbitrary `from` passed to `transferFrom` (or `safeTransferFrom`)

Passing an arbitrary `from` address to `transferFrom` (or `safeTransferFrom`) can lead to loss of funds, because anyone can transfer tokens from the `from` address if an approval is made.  

<details><summary>4 Found Instances</summary>


- Found in contracts/PaymentsUpgradeable.sol [Line: 56](contracts/PaymentsUpgradeable.sol#L56)

	```solidity
	            TransferHelper.safeTransferFrom(token, payer, recipient, value);
	```

- Found in contracts/lendingpool/LendingPool.sol [Line: 174](contracts/lendingpool/LendingPool.sol#L174)

	```solidity
	        IERC20(reserve.eTokenAddress).safeTransferFrom(_msgSender(), address(this), eTokenAmount);
	```

- Found in contracts/lendingpool/LendingPool.sol [Line: 354](contracts/lendingpool/LendingPool.sol#L354)

	```solidity
	        IERC20(reserve.underlyingTokenAddress).safeTransferFrom(_msgSender(), reserve.eTokenAddress, amount);
	```

- Found in contracts/lendingpool/Payments.sol [Line: 56](contracts/lendingpool/Payments.sol#L56)

	```solidity
	            TransferHelper.safeTransferFrom(token, payer, recipient, value);
	```

</details>



## H-3: Unprotected initializer

Consider protecting the initializer functions with modifiers.

<details><summary>2 Found Instances</summary>


- Found in contracts/PaymentsUpgradeable.sol [Line: 18](contracts/PaymentsUpgradeable.sol#L18)

	```solidity
	    function _initializePayments(address _WETH9) internal {
	```

- Found in contracts/lendingpool/LendingPool.sol [Line: 362](contracts/lendingpool/LendingPool.sol#L362)

	```solidity
	    function initReserve(
	```

</details>



## H-4: Experimental ABI Encoder

Experimental encoders should not be used in production. There are multiple known compiler bugs that are caused by the experimental encoder. Upgrade your solidity version to remove the need for experimental features.

<details><summary>1 Found Instances</summary>


- Found in contracts/interfaces/ILendingPool.sol [Line: 3](contracts/interfaces/ILendingPool.sol#L3)

	```solidity
	pragma experimental ABIEncoderV2;
	```

</details>



## H-5: Incorrect use of caret operator on a non hexadcimal constant

The caret operator is usually mistakenly thought of as an exponentiation operator but actually, it's a bitwise xor operator.

<details><summary>1 Found Instances</summary>


- Found in contracts/libraries/uniswap-v3/FullMath.sol [Line: 84](contracts/libraries/uniswap-v3/FullMath.sol#L84)

	```solidity
	            uint256 inv = (3 * denominator) ^ 2;
	```

</details>



## H-6: Yul block contains `return` function call.

Remove this, as this causes execution to halt. Nothing after that call will execute, including code following the assembly block.

<details><summary>1 Found Instances</summary>


- Found in contracts/IndividualPosition.sol [Line: 74](contracts/IndividualPosition.sol#L74)

	```solidity
	            default { return(0, returndatasize()) }
	```

</details>



## H-7: Functions send eth away from contract but performs no checks on any address.

Consider introducing checks for `msg.sender` to ensure the recipient of the money is as intended.

<details><summary>1 Found Instances</summary>


- Found in contracts/mock/MockWETH9.sol [Line: 25](contracts/mock/MockWETH9.sol#L25)

	```solidity
	    function withdraw(uint256 wad) public {
	```

</details>



## H-8: Delegatecall made by the function without checks on any address.

Introduce checks on the address

<details><summary>1 Found Instances</summary>


- Found in contracts/IndividualPosition.sol [Line: 12](contracts/IndividualPosition.sol#L12)

	```solidity
	    constructor(uint256 _positionId) {
	```

</details>



## H-9: Return value of the function call is not checked.

Function returns a value but it is ignored.

<details><summary>16 Found Instances</summary>


- Found in contracts/lendingpool/LendingPool.sol [Line: 307](contracts/lendingpool/LendingPool.sol#L307)

	```solidity
	        IExtraInterestBearingToken(reserve.eTokenAddress).transferUnderlyingTo(_msgSender(), amount);
	```

- Found in contracts/mock/MockTestBorrowableVault.sol [Line: 29](contracts/mock/MockTestBorrowableVault.sol#L29)

	```solidity
	        ILendingPool(lendingPool).repay(address(this), debtId, amount);
	```

- Found in contracts/shadow/ShadowRangePositionImpl.sol [Line: 90](contracts/shadow/ShadowRangePositionImpl.sol#L90)

	```solidity
	            _swapTokenExactInput(
	```

- Found in contracts/shadow/ShadowRangePositionImpl.sol [Line: 100](contracts/shadow/ShadowRangePositionImpl.sol#L100)

	```solidity
	            _swapTokenExactInput(
	```

- Found in contracts/shadow/ShadowRangePositionImpl.sol [Line: 173](contracts/shadow/ShadowRangePositionImpl.sol#L173)

	```solidity
	                _swapTokenExactInput(token1, token0, amount1Excess, currentDebt0 - token0Reduced);
	```

- Found in contracts/shadow/ShadowRangePositionImpl.sol [Line: 185](contracts/shadow/ShadowRangePositionImpl.sol#L185)

	```solidity
	                _swapTokenExactInput(token0, token1, amount0Excess, currentDebt1 - token1Reduced);
	```

- Found in contracts/shadow/ShadowRangePositionImpl.sol [Line: 217](contracts/shadow/ShadowRangePositionImpl.sol#L217)

	```solidity
	            _swapTokenExactInput(token0, token1, amount0ToSwap, 0);
	```

- Found in contracts/shadow/ShadowRangePositionImpl.sol [Line: 221](contracts/shadow/ShadowRangePositionImpl.sol#L221)

	```solidity
	            _swapTokenExactInput(token1, token0, amount1ToSwap, 0);
	```

- Found in contracts/shadow/ShadowRangePositionImpl.sol [Line: 310](contracts/shadow/ShadowRangePositionImpl.sol#L310)

	```solidity
	                _swapTokenExactInput(token1, token0, amount1Excess, currentDebt0 - token0Reduced);
	```

- Found in contracts/shadow/ShadowRangePositionImpl.sol [Line: 319](contracts/shadow/ShadowRangePositionImpl.sol#L319)

	```solidity
	                _swapTokenExactInput(token0, token1, amount0Excess, currentDebt1 - token1Reduced);
	```

- Found in contracts/shadow/ShadowRangePositionImpl.sol [Line: 355](contracts/shadow/ShadowRangePositionImpl.sol#L355)

	```solidity
	        IShadowNonfungiblePositionManager(getShadowNonfungiblePositionManager()).collect(
	```

- Found in contracts/shadow/ShadowRangePositionImpl.sol [Line: 409](contracts/shadow/ShadowRangePositionImpl.sol#L409)

	```solidity
	        IShadowNonfungiblePositionManager(getShadowNonfungiblePositionManager()).decreaseLiquidity(
	```

- Found in contracts/shadow/ShadowRangePositionImpl.sol [Line: 419](contracts/shadow/ShadowRangePositionImpl.sol#L419)

	```solidity
	        IShadowNonfungiblePositionManager(getShadowNonfungiblePositionManager()).collect(
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 263](contracts/shadow/ShadowRangeVault.sol#L263)

	```solidity
	            _closePosition(positionId);
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 322](contracts/shadow/ShadowRangeVault.sol#L322)

	```solidity
	            ILendingPool(lendingPool).repay(address(this), positionInfo.token0DebtId, amount0);
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 332](contracts/shadow/ShadowRangeVault.sol#L332)

	```solidity
	            ILendingPool(lendingPool).repay(address(this), positionInfo.token1DebtId, amount1);
	```

</details>



## H-10: Contract locks Ether without a withdraw function.

It appears that the contract includes a payable function to accept Ether but lacks a corresponding function to withdraw it, which leads to the Ether being locked in the contract. To resolve this issue, please implement a public or external function that allows for the withdrawal of Ether from the contract.

<details><summary>6 Found Instances</summary>


- Found in contracts/IndividualPosition.sol [Line: 9](contracts/IndividualPosition.sol#L9)

	```solidity
	contract IndividualPosition {
	```

- Found in contracts/PaymentsUpgradeable.sol [Line: 10](contracts/PaymentsUpgradeable.sol#L10)

	```solidity
	abstract contract PaymentsUpgradeable {
	```

- Found in contracts/lendingpool/LendingPool.sol [Line: 24](contracts/lendingpool/LendingPool.sol#L24)

	```solidity
	contract LendingPool is ILendingPool, OwnableUpgradeable, PaymentsUpgradeable, ReentrancyGuardUpgradeable {
	```

- Found in contracts/lendingpool/Payments.sol [Line: 10](contracts/lendingpool/Payments.sol#L10)

	```solidity
	abstract contract Payments {
	```

- Found in contracts/shadow/ShadowRangePositionImpl.sol [Line: 26](contracts/shadow/ShadowRangePositionImpl.sol#L26)

	```solidity
	contract ShadowRangePositionImpl is IShadowRangePositionImpl, PaymentsUpgradeable {
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 30](contracts/shadow/ShadowRangeVault.sol#L30)

	```solidity
	contract ShadowRangeVault is
	```

</details>



# Low Issues

## L-1: Centralization Risk for trusted owners

Contracts have owners with privileged rights to perform admin tasks and need to be trusted to not perform malicious updates or drain funds.

<details><summary>32 Found Instances</summary>


- Found in contracts/AddressRegistry.sol [Line: 7](contracts/AddressRegistry.sol#L7)

	```solidity
	contract AddressRegistry is IAddressRegistry, Ownable {
	```

- Found in contracts/AddressRegistry.sol [Line: 14](contracts/AddressRegistry.sol#L14)

	```solidity
	    function setAddress(uint256 id, address _addr) public onlyOwner {
	```

- Found in contracts/IndividualPosition.sol [Line: 49](contracts/IndividualPosition.sol#L49)

	```solidity
	    function changeOwner(address newOwner) external onlyOwner {
	```

- Found in contracts/VaultRegistry.sol [Line: 11](contracts/VaultRegistry.sol#L11)

	```solidity
	contract VaultRegistry is Ownable, IVaultFactory {
	```

- Found in contracts/VaultRegistry.sol [Line: 29](contracts/VaultRegistry.sol#L29)

	```solidity
	    function newVault(address _newVault) external onlyOwner returns (uint256 vaultId) {
	```

- Found in contracts/lendingpool/LendingPool.sol [Line: 69](contracts/lendingpool/LendingPool.sol#L69)

	```solidity
	    function initReserve(address asset) external onlyOwner notPaused {
	```

- Found in contracts/lendingpool/LendingPool.sol [Line: 535](contracts/lendingpool/LendingPool.sol#L535)

	```solidity
	    function emergencyPauseAll() external onlyOwner {
	```

- Found in contracts/lendingpool/LendingPool.sol [Line: 540](contracts/lendingpool/LendingPool.sol#L540)

	```solidity
	    function unPauseAll() external onlyOwner {
	```

- Found in contracts/lendingpool/LendingPool.sol [Line: 545](contracts/lendingpool/LendingPool.sol#L545)

	```solidity
	    function enableVaultToBorrow(uint256 vaultId) external onlyOwner notPaused {
	```

- Found in contracts/lendingpool/LendingPool.sol [Line: 552](contracts/lendingpool/LendingPool.sol#L552)

	```solidity
	    function disableVaultToBorrow(uint256 vaultId) external onlyOwner notPaused {
	```

- Found in contracts/lendingpool/LendingPool.sol [Line: 559](contracts/lendingpool/LendingPool.sol#L559)

	```solidity
	    function setCreditsOfVault(uint256 vaultId, uint256 reserveId, uint256 credit) external onlyOwner notPaused {
	```

- Found in contracts/lendingpool/LendingPool.sol [Line: 565](contracts/lendingpool/LendingPool.sol#L565)

	```solidity
	    function activateReserve(uint256 reserveId) public onlyOwner notPaused {
	```

- Found in contracts/lendingpool/LendingPool.sol [Line: 572](contracts/lendingpool/LendingPool.sol#L572)

	```solidity
	    function deActivateReserve(uint256 reserveId) public onlyOwner notPaused {
	```

- Found in contracts/lendingpool/LendingPool.sol [Line: 578](contracts/lendingpool/LendingPool.sol#L578)

	```solidity
	    function freezeReserve(uint256 reserveId) public onlyOwner notPaused {
	```

- Found in contracts/lendingpool/LendingPool.sol [Line: 584](contracts/lendingpool/LendingPool.sol#L584)

	```solidity
	    function unFreezeReserve(uint256 reserveId) public onlyOwner notPaused {
	```

- Found in contracts/lendingpool/LendingPool.sol [Line: 590](contracts/lendingpool/LendingPool.sol#L590)

	```solidity
	    function enableBorrowing(uint256 reserveId) public onlyOwner notPaused {
	```

- Found in contracts/lendingpool/LendingPool.sol [Line: 596](contracts/lendingpool/LendingPool.sol#L596)

	```solidity
	    function disableBorrowing(uint256 reserveId) public onlyOwner notPaused {
	```

- Found in contracts/lendingpool/LendingPool.sol [Line: 602](contracts/lendingpool/LendingPool.sol#L602)

	```solidity
	    function setReserveFeeRate(uint256 reserveId, uint16 _rate) public onlyOwner notPaused {
	```

- Found in contracts/lendingpool/LendingPool.sol [Line: 617](contracts/lendingpool/LendingPool.sol#L617)

	```solidity
	    ) public onlyOwner notPaused {
	```

- Found in contracts/lendingpool/LendingPool.sol [Line: 626](contracts/lendingpool/LendingPool.sol#L626)

	```solidity
	    function setReserveCapacity(uint256 reserveId, uint256 cap) public onlyOwner notPaused {
	```

- Found in contracts/lendingpool/StakingRewards.sol [Line: 13](contracts/lendingpool/StakingRewards.sol#L13)

	```solidity
	contract StakingRewards is Ownable, IStakingRewards {
	```

- Found in contracts/lendingpool/StakingRewards.sol [Line: 98](contracts/lendingpool/StakingRewards.sol#L98)

	```solidity
	        onlyOwner
	```

- Found in contracts/lendingpool/StakingRewards.sol [Line: 207](contracts/lendingpool/StakingRewards.sol#L207)

	```solidity
	    function update() external updateReward(address(0)) onlyOwner {}
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 110](contracts/shadow/ShadowRangeVault.sol#L110)

	```solidity
	    function setLiquidator(address _liquidator, bool _isLiquidator) external onlyOwner {
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 114](contracts/shadow/ShadowRangeVault.sol#L114)

	```solidity
	    function setLiquidationFeeParams(uint256 _liquidationFee, uint256 _liquidationCallerFeeRatio) external onlyOwner {
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 119](contracts/shadow/ShadowRangeVault.sol#L119)

	```solidity
	    function setOpenLiquidationEnabled(bool _openLiquidationEnabled) external onlyOwner {
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 123](contracts/shadow/ShadowRangeVault.sol#L123)

	```solidity
	    function setPositionImplementation(address _positionImplementation) external onlyOwner {
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 127](contracts/shadow/ShadowRangeVault.sol#L127)

	```solidity
	    function setLiquidationDebtRatio(uint256 _liquidationDebtRatio) external onlyOwner {
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 131](contracts/shadow/ShadowRangeVault.sol#L131)

	```solidity
	    function setReserveIds(uint256 _token0ReserveId, uint256 _token1ReserveId) external onlyOwner {
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 140](contracts/shadow/ShadowRangeVault.sol#L140)

	```solidity
	    function setMinPositionSize(uint256 _minPositionSize) external onlyOwner {
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 144](contracts/shadow/ShadowRangeVault.sol#L144)

	```solidity
	    function setPerformanceFee(uint256 _performanceFee) external onlyOwner {
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 148](contracts/shadow/ShadowRangeVault.sol#L148)

	```solidity
	    function setShadowGauge(address _shadowGauge) external onlyOwner {
	```

</details>



## L-2: Unsafe ERC20 Operations should not be used

ERC20 functions may not behave as expected. For example: return values are not always meaningful. It is recommended to use OpenZeppelin's SafeERC20 library.

<details><summary>31 Found Instances</summary>


- Found in contracts/PaymentsUpgradeable.sol [Line: 50](contracts/PaymentsUpgradeable.sol#L50)

	```solidity
	            require(IWETH9(WETH9).transfer(recipient, value), "transfer failed");
	```

- Found in contracts/lendingpool/LendingPool.sol [Line: 134](contracts/lendingpool/LendingPool.sol#L134)

	```solidity
	        IERC20(getETokenAddress(reserveId)).approve(stakingPool, eTokenAmount);
	```

- Found in contracts/lendingpool/Payments.sol [Line: 50](contracts/lendingpool/Payments.sol#L50)

	```solidity
	            require(IWETH9(WETH9).transfer(recipient, value), "transfer failed");
	```

- Found in contracts/lendingpool/StakingRewards.sol [Line: 165](contracts/lendingpool/StakingRewards.sol#L165)

	```solidity
	        require(stakedToken.transfer(to, amount), "transfer failed");
	```

- Found in contracts/lendingpool/StakingRewards.sol [Line: 190](contracts/lendingpool/StakingRewards.sol#L190)

	```solidity
	        require(stakedToken.transfer(to, amount), "transfer falied");
	```

- Found in contracts/lendingpool/StakingRewards.sol [Line: 201](contracts/lendingpool/StakingRewards.sol#L201)

	```solidity
	                require(IERC20(rewardToken).transfer(msg.sender, claimable), "transfer failed");
	```

- Found in contracts/libraries/TransferHelper.sol [Line: 15](contracts/libraries/TransferHelper.sol#L15)

	```solidity
	            token.call(abi.encodeWithSelector(IERC20.transferFrom.selector, from, to, value));
	```

- Found in contracts/libraries/TransferHelper.sol [Line: 25](contracts/libraries/TransferHelper.sol#L25)

	```solidity
	        (bool success, bytes memory data) = token.call(abi.encodeWithSelector(IERC20.transfer.selector, to, value));
	```

- Found in contracts/libraries/TransferHelper.sol [Line: 35](contracts/libraries/TransferHelper.sol#L35)

	```solidity
	        (bool success, bytes memory data) = token.call(abi.encodeWithSelector(IERC20.approve.selector, to, value));
	```

- Found in contracts/mock/MockTestBorrowableVault.sol [Line: 27](contracts/mock/MockTestBorrowableVault.sol#L27)

	```solidity
	        IERC20(token).transferFrom(msg.sender, address(this), amount);
	```

- Found in contracts/mock/MockTestBorrowableVault.sol [Line: 28](contracts/mock/MockTestBorrowableVault.sol#L28)

	```solidity
	        IERC20(token).approve(lendingPool, amount);
	```

- Found in contracts/mock/MockWETH9.sol [Line: 28](contracts/mock/MockWETH9.sol#L28)

	```solidity
	        payable(msg.sender).transfer(wad);
	```

- Found in contracts/shadow/ShadowRangePositionImpl.sol [Line: 51](contracts/shadow/ShadowRangePositionImpl.sol#L51)

	```solidity
	        IERC20(token0).approve(vault, type(uint256).max);
	```

- Found in contracts/shadow/ShadowRangePositionImpl.sol [Line: 52](contracts/shadow/ShadowRangePositionImpl.sol#L52)

	```solidity
	        IERC20(token1).approve(vault, type(uint256).max);
	```

- Found in contracts/shadow/ShadowRangePositionImpl.sol [Line: 109](contracts/shadow/ShadowRangePositionImpl.sol#L109)

	```solidity
	        IERC20(token0).approve(shadowNonfungiblePositionManager, params.amount0Desired);
	```

- Found in contracts/shadow/ShadowRangePositionImpl.sol [Line: 110](contracts/shadow/ShadowRangePositionImpl.sol#L110)

	```solidity
	        IERC20(token1).approve(shadowNonfungiblePositionManager, params.amount1Desired);
	```

- Found in contracts/shadow/ShadowRangePositionImpl.sol [Line: 175](contracts/shadow/ShadowRangePositionImpl.sol#L175)

	```solidity
	            IERC20(token0).approve(vault, currentDebt0);
	```

- Found in contracts/shadow/ShadowRangePositionImpl.sol [Line: 187](contracts/shadow/ShadowRangePositionImpl.sol#L187)

	```solidity
	            IERC20(token1).approve(vault, currentDebt1);
	```

- Found in contracts/shadow/ShadowRangePositionImpl.sol [Line: 228](contracts/shadow/ShadowRangePositionImpl.sol#L228)

	```solidity
	            IERC20(token0).approve(vault, token0Left);
	```

- Found in contracts/shadow/ShadowRangePositionImpl.sol [Line: 232](contracts/shadow/ShadowRangePositionImpl.sol#L232)

	```solidity
	            IERC20(token1).approve(vault, token1Left);
	```

- Found in contracts/shadow/ShadowRangePositionImpl.sol [Line: 312](contracts/shadow/ShadowRangePositionImpl.sol#L312)

	```solidity
	            IERC20(token0).approve(vault, currentDebt0);
	```

- Found in contracts/shadow/ShadowRangePositionImpl.sol [Line: 321](contracts/shadow/ShadowRangePositionImpl.sol#L321)

	```solidity
	            IERC20(token1).approve(vault, currentDebt1);
	```

- Found in contracts/shadow/ShadowRangePositionImpl.sol [Line: 367](contracts/shadow/ShadowRangePositionImpl.sol#L367)

	```solidity
	            IERC20(token0).approve(vault, token0Fees);
	```

- Found in contracts/shadow/ShadowRangePositionImpl.sol [Line: 371](contracts/shadow/ShadowRangePositionImpl.sol#L371)

	```solidity
	            IERC20(token1).approve(vault, token1Fees);
	```

- Found in contracts/shadow/ShadowRangePositionImpl.sol [Line: 393](contracts/shadow/ShadowRangePositionImpl.sol#L393)

	```solidity
	                            IERC20(tokens[i]).approve(x33Adapter, balance);
	```

- Found in contracts/shadow/ShadowRangePositionImpl.sol [Line: 396](contracts/shadow/ShadowRangePositionImpl.sol#L396)

	```solidity
	                            IERC20(x33).approve(vault, balance);
	```

- Found in contracts/shadow/ShadowRangePositionImpl.sol [Line: 400](contracts/shadow/ShadowRangePositionImpl.sol#L400)

	```solidity
	                        IERC20(tokens[i]).approve(vault, balance);
	```

- Found in contracts/shadow/ShadowRangePositionImpl.sol [Line: 438](contracts/shadow/ShadowRangePositionImpl.sol#L438)

	```solidity
	        IERC20(tokenIn).approve(router, amountIn);
	```

- Found in contracts/shadow/ShadowRangePositionImpl.sol [Line: 460](contracts/shadow/ShadowRangePositionImpl.sol#L460)

	```solidity
	        IERC20(tokenIn).approve(router, amountInMaximum);
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 134](contracts/shadow/ShadowRangeVault.sol#L134)

	```solidity
	        IERC20(token0).approve(lendingPool, type(uint256).max);
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 135](contracts/shadow/ShadowRangeVault.sol#L135)

	```solidity
	        IERC20(token1).approve(lendingPool, type(uint256).max);
	```

</details>



## L-3: Solidity pragma should be specific, not wide

Consider using a specific version of Solidity in your contracts instead of a wide version. For example, instead of `pragma solidity ^0.8.0;`, use `pragma solidity 0.8.0;`

<details><summary>37 Found Instances</summary>


- Found in contracts/AddressRegistry.sol [Line: 2](contracts/AddressRegistry.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in contracts/IndividualPosition.sol [Line: 3](contracts/IndividualPosition.sol#L3)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in contracts/MightyTimelockController.sol [Line: 3](contracts/MightyTimelockController.sol#L3)

	```solidity
	pragma solidity ^0.8.18;
	```

- Found in contracts/PaymentsUpgradeable.sol [Line: 2](contracts/PaymentsUpgradeable.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in contracts/PrimaryPriceOracle.sol [Line: 3](contracts/PrimaryPriceOracle.sol#L3)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in contracts/VaultRegistry.sol [Line: 2](contracts/VaultRegistry.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in contracts/interfaces/IAddressRegistry.sol [Line: 2](contracts/interfaces/IAddressRegistry.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in contracts/interfaces/IExtraInterestBearingToken.sol [Line: 2](contracts/interfaces/IExtraInterestBearingToken.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in contracts/interfaces/ILendingPool.sol [Line: 2](contracts/interfaces/ILendingPool.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in contracts/interfaces/IPayments.sol [Line: 3](contracts/interfaces/IPayments.sol#L3)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in contracts/interfaces/IPositionValueCalculator.sol [Line: 2](contracts/interfaces/IPositionValueCalculator.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in contracts/interfaces/IPriceOracle.sol [Line: 3](contracts/interfaces/IPriceOracle.sol#L3)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in contracts/interfaces/IShadowGaugeV3.sol [Line: 2](contracts/interfaces/IShadowGaugeV3.sol#L2)

	```solidity
	pragma solidity ^0.8.18;
	```

- Found in contracts/interfaces/IShadowNonfungiblePositionManager.sol [Line: 2](contracts/interfaces/IShadowNonfungiblePositionManager.sol#L2)

	```solidity
	pragma solidity >=0.7.5;
	```

- Found in contracts/interfaces/IShadowRangePositionImpl.sol [Line: 3](contracts/interfaces/IShadowRangePositionImpl.sol#L3)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in contracts/interfaces/IShadowRangeVault.sol [Line: 3](contracts/interfaces/IShadowRangeVault.sol#L3)

	```solidity
	pragma solidity ^0.8.18;
	```

- Found in contracts/interfaces/IShadowSwapRouter.sol [Line: 2](contracts/interfaces/IShadowSwapRouter.sol#L2)

	```solidity
	pragma solidity >=0.7.5;
	```

- Found in contracts/interfaces/IShadowV3Pool.sol [Line: 3](contracts/interfaces/IShadowV3Pool.sol#L3)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in contracts/interfaces/IShadowX33.sol [Line: 3](contracts/interfaces/IShadowX33.sol#L3)

	```solidity
	pragma solidity ^0.8.18;
	```

- Found in contracts/interfaces/IStakingRewards.sol [Line: 2](contracts/interfaces/IStakingRewards.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in contracts/interfaces/ISwapXNonfungiblePositionManager.sol [Line: 2](contracts/interfaces/ISwapXNonfungiblePositionManager.sol#L2)

	```solidity
	pragma solidity >=0.7.5;
	```

- Found in contracts/interfaces/ISwapXSwapRouter.sol [Line: 2](contracts/interfaces/ISwapXSwapRouter.sol#L2)

	```solidity
	pragma solidity >=0.7.5;
	```

- Found in contracts/interfaces/ISwapXV3Pool.sol [Line: 3](contracts/interfaces/ISwapXV3Pool.sol#L3)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in contracts/interfaces/IVault.sol [Line: 2](contracts/interfaces/IVault.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in contracts/interfaces/IVaultFactory.sol [Line: 2](contracts/interfaces/IVaultFactory.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in contracts/interfaces/IWETH9.sol [Line: 2](contracts/interfaces/IWETH9.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in contracts/lendingpool/ExtraInterestBearingToken.sol [Line: 2](contracts/lendingpool/ExtraInterestBearingToken.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in contracts/lendingpool/LendingPool.sol [Line: 2](contracts/lendingpool/LendingPool.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in contracts/lendingpool/Payments.sol [Line: 2](contracts/lendingpool/Payments.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in contracts/lendingpool/StakingRewards.sol [Line: 2](contracts/lendingpool/StakingRewards.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in contracts/mock/MockTestBorrowableVault.sol [Line: 3](contracts/mock/MockTestBorrowableVault.sol#L3)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in contracts/mock/MockWETH9.sol [Line: 2](contracts/mock/MockWETH9.sol#L2)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in contracts/shadow/ShadowPositionValueCalculator.sol [Line: 3](contracts/shadow/ShadowPositionValueCalculator.sol#L3)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in contracts/shadow/ShadowRangePositionImpl.sol [Line: 3](contracts/shadow/ShadowRangePositionImpl.sol#L3)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 3](contracts/shadow/ShadowRangeVault.sol#L3)

	```solidity
	pragma solidity ^0.8.18;
	```

- Found in contracts/swapx/SwapXPositionValueCalculator.sol [Line: 3](contracts/swapx/SwapXPositionValueCalculator.sol#L3)

	```solidity
	pragma solidity ^0.8.0;
	```

- Found in contracts/viewer/VaultPositionViewer.sol [Line: 3](contracts/viewer/VaultPositionViewer.sol#L3)

	```solidity
	pragma solidity ^0.8.0;
	```

</details>



## L-4: Missing checks for `address(0)` when assigning values to address state variables

Check for `address(0)` when assigning values to address state variables.

<details><summary>14 Found Instances</summary>


- Found in contracts/PaymentsUpgradeable.sol [Line: 19](contracts/PaymentsUpgradeable.sol#L19)

	```solidity
	        WETH9 = _WETH9;
	```

- Found in contracts/PrimaryPriceOracle.sol [Line: 24](contracts/PrimaryPriceOracle.sol#L24)

	```solidity
	        pyth = IPyth(_pyth);
	```

- Found in contracts/PrimaryPriceOracle.sol [Line: 25](contracts/PrimaryPriceOracle.sol#L25)

	```solidity
	        oracleManager = _oracleManager;
	```

- Found in contracts/mock/MockTestBorrowableVault.sol [Line: 16](contracts/mock/MockTestBorrowableVault.sol#L16)

	```solidity
	        lendingPool = _lendingPool;
	```

- Found in contracts/shadow/ShadowRangePositionImpl.sol [Line: 130](contracts/shadow/ShadowRangePositionImpl.sol#L130)

	```solidity
	        positionOwner = params.positionOwner;
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 92](contracts/shadow/ShadowRangeVault.sol#L92)

	```solidity
	        token0 = IShadowV3Pool(_shadowV3PoolAddress).token0();
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 93](contracts/shadow/ShadowRangeVault.sol#L93)

	```solidity
	        token1 = IShadowV3Pool(_shadowV3PoolAddress).token1();
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 97](contracts/shadow/ShadowRangeVault.sol#L97)

	```solidity
	        addressProvider = _addressProvider;
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 98](contracts/shadow/ShadowRangeVault.sol#L98)

	```solidity
	        vaultRegistry = _vaultRegistry;
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 100](contracts/shadow/ShadowRangeVault.sol#L100)

	```solidity
	        shadowV3Pool = _shadowV3PoolAddress;
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 107](contracts/shadow/ShadowRangeVault.sol#L107)

	```solidity
	        positionImplementation = _initialPositionImplementation;
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 124](contracts/shadow/ShadowRangeVault.sol#L124)

	```solidity
	        positionImplementation = _positionImplementation;
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 149](contracts/shadow/ShadowRangeVault.sol#L149)

	```solidity
	        shadowGauge = _shadowGauge;
	```

- Found in contracts/viewer/VaultPositionViewer.sol [Line: 35](contracts/viewer/VaultPositionViewer.sol#L35)

	```solidity
	        addressProvider = _addressProvider;
	```

</details>



## L-5: `public` functions not used internally could be marked `external`

Instead of marking a function as `public`, consider marking it as `external` if it is not used internally.

<details><summary>36 Found Instances</summary>


- Found in contracts/PrimaryPriceOracle.sol [Line: 52](contracts/PrimaryPriceOracle.sol#L52)

	```solidity
	    function getTokenPrice(address token) public view returns (uint256) {
	```

- Found in contracts/lendingpool/ExtraInterestBearingToken.sol [Line: 102](contracts/lendingpool/ExtraInterestBearingToken.sol#L102)

	```solidity
	    function decimals() public view override returns (uint8) {
	```

- Found in contracts/lendingpool/LendingPool.sol [Line: 57](contracts/lendingpool/LendingPool.sol#L57)

	```solidity
	    function initialize(address _addressRegistry, address _WETH9) public initializer {
	```

- Found in contracts/lendingpool/LendingPool.sol [Line: 104](contracts/lendingpool/LendingPool.sol#L104)

	```solidity
	    function deposit(uint256 reserveId, uint256 amount, address onBehalfOf, uint16 referralCode)
	```

- Found in contracts/lendingpool/LendingPool.sol [Line: 160](contracts/lendingpool/LendingPool.sol#L160)

	```solidity
	    function redeem(uint256 reserveId, uint256 eTokenAmount, address to, bool receiveNativeETH)
	```

- Found in contracts/lendingpool/LendingPool.sol [Line: 490](contracts/lendingpool/LendingPool.sol#L490)

	```solidity
	    function getReserveIdOfDebt(uint256 debtId) public view returns (uint256) {
	```

- Found in contracts/lendingpool/LendingPool.sol [Line: 494](contracts/lendingpool/LendingPool.sol#L494)

	```solidity
	    function getUnderlyingTokenAddress(uint256 reserveId) public view returns (address) {
	```

- Found in contracts/lendingpool/LendingPool.sol [Line: 504](contracts/lendingpool/LendingPool.sol#L504)

	```solidity
	    function getStakingAddress(uint256 reserveId) public view returns (address) {
	```

- Found in contracts/lendingpool/LendingPool.sol [Line: 509](contracts/lendingpool/LendingPool.sol#L509)

	```solidity
	    function exchangeRateOfReserve(uint256 reserveId) public view returns (uint256) {
	```

- Found in contracts/lendingpool/LendingPool.sol [Line: 514](contracts/lendingpool/LendingPool.sol#L514)

	```solidity
	    function utilizationRateOfReserve(uint256 reserveId) public view returns (uint256) {
	```

- Found in contracts/lendingpool/LendingPool.sol [Line: 519](contracts/lendingpool/LendingPool.sol#L519)

	```solidity
	    function borrowingRateOfReserve(uint256 reserveId) public view returns (uint256) {
	```

- Found in contracts/lendingpool/LendingPool.sol [Line: 524](contracts/lendingpool/LendingPool.sol#L524)

	```solidity
	    function totalLiquidityOfReserve(uint256 reserveId) public view returns (uint256 totalLiquidity) {
	```

- Found in contracts/lendingpool/LendingPool.sol [Line: 529](contracts/lendingpool/LendingPool.sol#L529)

	```solidity
	    function totalBorrowsOfReserve(uint256 reserveId) public view returns (uint256 totalBorrows) {
	```

- Found in contracts/lendingpool/LendingPool.sol [Line: 565](contracts/lendingpool/LendingPool.sol#L565)

	```solidity
	    function activateReserve(uint256 reserveId) public onlyOwner notPaused {
	```

- Found in contracts/lendingpool/LendingPool.sol [Line: 572](contracts/lendingpool/LendingPool.sol#L572)

	```solidity
	    function deActivateReserve(uint256 reserveId) public onlyOwner notPaused {
	```

- Found in contracts/lendingpool/LendingPool.sol [Line: 578](contracts/lendingpool/LendingPool.sol#L578)

	```solidity
	    function freezeReserve(uint256 reserveId) public onlyOwner notPaused {
	```

- Found in contracts/lendingpool/LendingPool.sol [Line: 584](contracts/lendingpool/LendingPool.sol#L584)

	```solidity
	    function unFreezeReserve(uint256 reserveId) public onlyOwner notPaused {
	```

- Found in contracts/lendingpool/LendingPool.sol [Line: 590](contracts/lendingpool/LendingPool.sol#L590)

	```solidity
	    function enableBorrowing(uint256 reserveId) public onlyOwner notPaused {
	```

- Found in contracts/lendingpool/LendingPool.sol [Line: 596](contracts/lendingpool/LendingPool.sol#L596)

	```solidity
	    function disableBorrowing(uint256 reserveId) public onlyOwner notPaused {
	```

- Found in contracts/lendingpool/LendingPool.sol [Line: 602](contracts/lendingpool/LendingPool.sol#L602)

	```solidity
	    function setReserveFeeRate(uint256 reserveId, uint16 _rate) public onlyOwner notPaused {
	```

- Found in contracts/lendingpool/LendingPool.sol [Line: 610](contracts/lendingpool/LendingPool.sol#L610)

	```solidity
	    function setBorrowingRateConfig(
	```

- Found in contracts/lendingpool/LendingPool.sol [Line: 626](contracts/lendingpool/LendingPool.sol#L626)

	```solidity
	    function setReserveCapacity(uint256 reserveId, uint256 cap) public onlyOwner notPaused {
	```

- Found in contracts/lendingpool/StakingRewards.sol [Line: 84](contracts/lendingpool/StakingRewards.sol#L84)

	```solidity
	    function earned(address user, address rewardToken) public view returns (uint256) {
	```

- Found in contracts/lendingpool/StakingRewards.sol [Line: 96](contracts/lendingpool/StakingRewards.sol#L96)

	```solidity
	    function setReward(address rewardToken, uint256 startTime, uint256 endTime, uint256 totalRewards)
	```

- Found in contracts/mock/MockWETH9.sol [Line: 25](contracts/mock/MockWETH9.sol#L25)

	```solidity
	    function withdraw(uint256 wad) public {
	```

- Found in contracts/shadow/ShadowPositionValueCalculator.sol [Line: 18](contracts/shadow/ShadowPositionValueCalculator.sol#L18)

	```solidity
	    function principal(IShadowNonfungiblePositionManager positionManager, uint256 tokenId, address pool)
	```

- Found in contracts/shadow/ShadowPositionValueCalculator.sol [Line: 33](contracts/shadow/ShadowPositionValueCalculator.sol#L33)

	```solidity
	    function getCurrentTick(address v3Pool) public view returns (int24) {
	```

- Found in contracts/shadow/ShadowRangePositionImpl.sol [Line: 79](contracts/shadow/ShadowRangePositionImpl.sol#L79)

	```solidity
	    function getSwapRouter() public view returns (address) {
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 83](contracts/shadow/ShadowRangeVault.sol#L83)

	```solidity
	    function initialize(
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 468](contracts/shadow/ShadowRangeVault.sol#L468)

	```solidity
	    function getPositionIds(address owner) public view returns (uint256[] memory) {
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 472](contracts/shadow/ShadowRangeVault.sol#L472)

	```solidity
	    function getPositionInfos(uint256 positionId) public view returns (PositionInfo memory) {
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 476](contracts/shadow/ShadowRangeVault.sol#L476)

	```solidity
	    function liquidationFeeRecipient() public view returns (address) {
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 484](contracts/shadow/ShadowRangeVault.sol#L484)

	```solidity
	    function getCurrentTick() public view returns (int24) {
	```

- Found in contracts/swapx/SwapXPositionValueCalculator.sol [Line: 18](contracts/swapx/SwapXPositionValueCalculator.sol#L18)

	```solidity
	    function principal(ISwapXNonfungiblePositionManager positionManager, uint256 tokenId, address pool)
	```

- Found in contracts/swapx/SwapXPositionValueCalculator.sol [Line: 32](contracts/swapx/SwapXPositionValueCalculator.sol#L32)

	```solidity
	    function getCurrentTick(address v3Pool) public view returns (int24) {
	```

- Found in contracts/viewer/VaultPositionViewer.sol [Line: 107](contracts/viewer/VaultPositionViewer.sol#L107)

	```solidity
	    function getUserPositions(address[] memory vaults, address owner) public view returns (PositionInfo[][] memory) {
	```

</details>



## L-6: Define and use `constant` variables instead of using literals

If the same constant literal value is used multiple times, create a constant state variable and reference it throughout the contract.

<details><summary>50 Found Instances</summary>


- Found in contracts/lendingpool/StakingRewards.sol [Line: 81](contracts/lendingpool/StakingRewards.sol#L81)

	```solidity
	            + (rewardData[rewardToken].rewardRate * dt * 1e18) / totalStaked;
	```

- Found in contracts/lendingpool/StakingRewards.sol [Line: 93](contracts/lendingpool/StakingRewards.sol#L93)

	```solidity
	        return (balanceOf[user] * d) / 1e18 + userRewardsClaimable[user][rewardToken];
	```

- Found in contracts/lendingpool/StakingRewards.sol [Line: 119](contracts/lendingpool/StakingRewards.sol#L119)

	```solidity
	                (rewardData[rewardToken].rewardRate * dt * 1e18) / totalStaked;
	```

- Found in contracts/libraries/uniswap-v3/TickMath.sol [Line: 33](contracts/libraries/uniswap-v3/TickMath.sol#L33)

	```solidity
	            if (absTick & 0x2 != 0) ratio = (ratio * 0xfff97272373d413259a46990580e213a) >> 128;
	```

- Found in contracts/libraries/uniswap-v3/TickMath.sol [Line: 34](contracts/libraries/uniswap-v3/TickMath.sol#L34)

	```solidity
	            if (absTick & 0x4 != 0) ratio = (ratio * 0xfff2e50f5f656932ef12357cf3c7fdcc) >> 128;
	```

- Found in contracts/libraries/uniswap-v3/TickMath.sol [Line: 35](contracts/libraries/uniswap-v3/TickMath.sol#L35)

	```solidity
	            if (absTick & 0x8 != 0) ratio = (ratio * 0xffe5caca7e10e4e61c3624eaa0941cd0) >> 128;
	```

- Found in contracts/libraries/uniswap-v3/TickMath.sol [Line: 36](contracts/libraries/uniswap-v3/TickMath.sol#L36)

	```solidity
	            if (absTick & 0x10 != 0) ratio = (ratio * 0xffcb9843d60f6159c9db58835c926644) >> 128;
	```

- Found in contracts/libraries/uniswap-v3/TickMath.sol [Line: 37](contracts/libraries/uniswap-v3/TickMath.sol#L37)

	```solidity
	            if (absTick & 0x20 != 0) ratio = (ratio * 0xff973b41fa98c081472e6896dfb254c0) >> 128;
	```

- Found in contracts/libraries/uniswap-v3/TickMath.sol [Line: 38](contracts/libraries/uniswap-v3/TickMath.sol#L38)

	```solidity
	            if (absTick & 0x40 != 0) ratio = (ratio * 0xff2ea16466c96a3843ec78b326b52861) >> 128;
	```

- Found in contracts/libraries/uniswap-v3/TickMath.sol [Line: 39](contracts/libraries/uniswap-v3/TickMath.sol#L39)

	```solidity
	            if (absTick & 0x80 != 0) ratio = (ratio * 0xfe5dee046a99a2a811c461f1969c3053) >> 128;
	```

- Found in contracts/libraries/uniswap-v3/TickMath.sol [Line: 40](contracts/libraries/uniswap-v3/TickMath.sol#L40)

	```solidity
	            if (absTick & 0x100 != 0) ratio = (ratio * 0xfcbe86c7900a88aedcffc83b479aa3a4) >> 128;
	```

- Found in contracts/libraries/uniswap-v3/TickMath.sol [Line: 41](contracts/libraries/uniswap-v3/TickMath.sol#L41)

	```solidity
	            if (absTick & 0x200 != 0) ratio = (ratio * 0xf987a7253ac413176f2b074cf7815e54) >> 128;
	```

- Found in contracts/libraries/uniswap-v3/TickMath.sol [Line: 42](contracts/libraries/uniswap-v3/TickMath.sol#L42)

	```solidity
	            if (absTick & 0x400 != 0) ratio = (ratio * 0xf3392b0822b70005940c7a398e4b70f3) >> 128;
	```

- Found in contracts/libraries/uniswap-v3/TickMath.sol [Line: 43](contracts/libraries/uniswap-v3/TickMath.sol#L43)

	```solidity
	            if (absTick & 0x800 != 0) ratio = (ratio * 0xe7159475a2c29b7443b29c7fa6e889d9) >> 128;
	```

- Found in contracts/libraries/uniswap-v3/TickMath.sol [Line: 44](contracts/libraries/uniswap-v3/TickMath.sol#L44)

	```solidity
	            if (absTick & 0x1000 != 0) ratio = (ratio * 0xd097f3bdfd2022b8845ad8f792aa5825) >> 128;
	```

- Found in contracts/libraries/uniswap-v3/TickMath.sol [Line: 45](contracts/libraries/uniswap-v3/TickMath.sol#L45)

	```solidity
	            if (absTick & 0x2000 != 0) ratio = (ratio * 0xa9f746462d870fdf8a65dc1f90e061e5) >> 128;
	```

- Found in contracts/libraries/uniswap-v3/TickMath.sol [Line: 46](contracts/libraries/uniswap-v3/TickMath.sol#L46)

	```solidity
	            if (absTick & 0x4000 != 0) ratio = (ratio * 0x70d869a156d2a1b890bb3df62baf32f7) >> 128;
	```

- Found in contracts/libraries/uniswap-v3/TickMath.sol [Line: 47](contracts/libraries/uniswap-v3/TickMath.sol#L47)

	```solidity
	            if (absTick & 0x8000 != 0) ratio = (ratio * 0x31be135f97d08fd981231505542fcfa6) >> 128;
	```

- Found in contracts/libraries/uniswap-v3/TickMath.sol [Line: 48](contracts/libraries/uniswap-v3/TickMath.sol#L48)

	```solidity
	            if (absTick & 0x10000 != 0) ratio = (ratio * 0x9aa508b5b7a84e1c677de54f3e99bc9) >> 128;
	```

- Found in contracts/libraries/uniswap-v3/TickMath.sol [Line: 49](contracts/libraries/uniswap-v3/TickMath.sol#L49)

	```solidity
	            if (absTick & 0x20000 != 0) ratio = (ratio * 0x5d6af8dedb81196699c329225ee604) >> 128;
	```

- Found in contracts/libraries/uniswap-v3/TickMath.sol [Line: 50](contracts/libraries/uniswap-v3/TickMath.sol#L50)

	```solidity
	            if (absTick & 0x40000 != 0) ratio = (ratio * 0x2216e584f5fa1ea926041bedfe98) >> 128;
	```

- Found in contracts/libraries/uniswap-v3/TickMath.sol [Line: 51](contracts/libraries/uniswap-v3/TickMath.sol#L51)

	```solidity
	            if (absTick & 0x80000 != 0) ratio = (ratio * 0x48a170391f7dc42444e8fa2) >> 128;
	```

- Found in contracts/libraries/uniswap-v3/TickMath.sol [Line: 58](contracts/libraries/uniswap-v3/TickMath.sol#L58)

	```solidity
	            sqrtPriceX96 = uint160((ratio >> 32) + (ratio % (1 << 32) == 0 ? 0 : 1));
	```

- Found in contracts/libraries/uniswap-v3/TickMath.sol [Line: 71](contracts/libraries/uniswap-v3/TickMath.sol#L71)

	```solidity
	            uint256 ratio = uint256(sqrtPriceX96) << 32;
	```

- Found in contracts/libraries/uniswap-v3/TickMath.sol [Line: 116](contracts/libraries/uniswap-v3/TickMath.sol#L116)

	```solidity
	            if (msb >= 128) r = ratio >> (msb - 127);
	```

- Found in contracts/libraries/uniswap-v3/TickMath.sol [Line: 117](contracts/libraries/uniswap-v3/TickMath.sol#L117)

	```solidity
	            else r = ratio << (127 - msb);
	```

- Found in contracts/libraries/uniswap-v3/TickMath.sol [Line: 119](contracts/libraries/uniswap-v3/TickMath.sol#L119)

	```solidity
	            int256 log_2 = (int256(msb) - 128) << 64;
	```

- Found in contracts/libraries/uniswap-v3/TickMath.sol [Line: 209](contracts/libraries/uniswap-v3/TickMath.sol#L209)

	```solidity
	            int24 tickLow = int24((log_sqrt10001 - 3402992956809132418596140100660247210) >> 128);
	```

- Found in contracts/libraries/uniswap-v3/TickMath.sol [Line: 210](contracts/libraries/uniswap-v3/TickMath.sol#L210)

	```solidity
	            int24 tickHi = int24((log_sqrt10001 + 291339464771989622907027621153398088495) >> 128);
	```

- Found in contracts/shadow/ShadowRangePositionImpl.sol [Line: 212](contracts/shadow/ShadowRangePositionImpl.sol#L212)

	```solidity
	        reduceLiquidity = liquidity * reducePercentage / 10000;
	```

- Found in contracts/shadow/ShadowRangePositionImpl.sol [Line: 282](contracts/shadow/ShadowRangePositionImpl.sol#L282)

	```solidity
	            token0Fees = token0Reduced * vars.liquidationFee / 10000;
	```

- Found in contracts/shadow/ShadowRangePositionImpl.sol [Line: 285](contracts/shadow/ShadowRangePositionImpl.sol#L285)

	```solidity
	            uint256 token0CallerFees = token0Fees * vars.liquidationCallerFee / 10000;
	```

- Found in contracts/shadow/ShadowRangePositionImpl.sol [Line: 294](contracts/shadow/ShadowRangePositionImpl.sol#L294)

	```solidity
	            token1Fees = token1Reduced * vars.liquidationFee / 10000;
	```

- Found in contracts/shadow/ShadowRangePositionImpl.sol [Line: 298](contracts/shadow/ShadowRangePositionImpl.sol#L298)

	```solidity
	            uint256 token1CallerFees = token1Fees * vars.liquidationCallerFee / 10000;
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 297](contracts/shadow/ShadowRangeVault.sol#L297)

	```solidity
	        require(params.reducePercentage > 0 && params.reducePercentage < 10000, "Invalid reduce percentage");
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 384](contracts/shadow/ShadowRangeVault.sol#L384)

	```solidity
	        uint256 feeAmount = amount * performanceFee / 10000;
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 421](contracts/shadow/ShadowRangeVault.sol#L421)

	```solidity
	        return amount0 * getTokenPrice(token0) / 10 ** token0Decimals
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 422](contracts/shadow/ShadowRangeVault.sol#L422)

	```solidity
	            + amount1 * getTokenPrice(token1) / 10 ** token1Decimals;
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 427](contracts/shadow/ShadowRangeVault.sol#L427)

	```solidity
	        return amount0 * getTokenPrice(token0) / 10 ** token0Decimals
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 428](contracts/shadow/ShadowRangeVault.sol#L428)

	```solidity
	            + amount1 * getTokenPrice(token1) / 10 ** token1Decimals;
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 433](contracts/shadow/ShadowRangeVault.sol#L433)

	```solidity
	        return amount0Debt * getTokenPrice(token0) / 10 ** token0Decimals
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 434](contracts/shadow/ShadowRangeVault.sol#L434)

	```solidity
	            + amount1Debt * getTokenPrice(token1) / 10 ** token1Decimals;
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 453](contracts/shadow/ShadowRangeVault.sol#L453)

	```solidity
	        uint256 principalValue = amount0Principal * getTokenPrice(token0) / 10 ** token0Decimals
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 454](contracts/shadow/ShadowRangeVault.sol#L454)

	```solidity
	            + amount1Principal * getTokenPrice(token1) / 10 ** token1Decimals;
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 455](contracts/shadow/ShadowRangeVault.sol#L455)

	```solidity
	        uint256 borrowValue = amount0Borrow * getTokenPrice(token0) / 10 ** token0Decimals
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 456](contracts/shadow/ShadowRangeVault.sol#L456)

	```solidity
	            + amount1Borrow * getTokenPrice(token1) / 10 ** token1Decimals;
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 457](contracts/shadow/ShadowRangeVault.sol#L457)

	```solidity
	        return borrowValue * 10000 / (principalValue + borrowValue);
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 461](contracts/shadow/ShadowRangeVault.sol#L461)

	```solidity
	        return getDebtValue(positionId) * 10000 / getPositionValue(positionId);
	```

</details>



## L-7: Event is missing `indexed` fields

Index event fields make the field more quickly accessible to off-chain tools that parse events. However, note that each index field costs extra gas during emission, so it's not necessarily best to index the maximum allowed per event (three fields). Each event should use three indexed fields if there are three or more fields, and gas usage is not particularly of concern for the events in question. If there are fewer than three fields, all of the fields should be indexed.

<details><summary>34 Found Instances</summary>


- Found in contracts/IndividualPosition.sol [Line: 21](contracts/IndividualPosition.sol#L21)

	```solidity
	    event OwnerChanged(address previousOwner, address newOwner);
	```

- Found in contracts/interfaces/IAddressRegistry.sol [Line: 7](contracts/interfaces/IAddressRegistry.sol#L7)

	```solidity
	    event SetAddress(
	```

- Found in contracts/interfaces/IExtraInterestBearingToken.sol [Line: 13](contracts/interfaces/IExtraInterestBearingToken.sol#L13)

	```solidity
	    event Mint(address indexed to, uint256 value);
	```

- Found in contracts/interfaces/IExtraInterestBearingToken.sol [Line: 30](contracts/interfaces/IExtraInterestBearingToken.sol#L30)

	```solidity
	    event Burn(address indexed from, address indexed target, uint256 eTokenAmount, uint256 underlyingTokenAmount);
	```

- Found in contracts/interfaces/IExtraInterestBearingToken.sol [Line: 49](contracts/interfaces/IExtraInterestBearingToken.sol#L49)

	```solidity
	    event MintToTreasury(address indexed treasury, uint256 value);
	```

- Found in contracts/interfaces/ILendingPool.sol [Line: 28](contracts/interfaces/ILendingPool.sol#L28)

	```solidity
	    event InitReserve(
	```

- Found in contracts/interfaces/ILendingPool.sol [Line: 123](contracts/interfaces/ILendingPool.sol#L123)

	```solidity
	    event SetInterestRateConfig(
	```

- Found in contracts/interfaces/ILendingPool.sol [Line: 132](contracts/interfaces/ILendingPool.sol#L132)

	```solidity
	    event SetReserveCapacity(uint256 indexed reserveId, uint256 cap);
	```

- Found in contracts/interfaces/ILendingPool.sol [Line: 134](contracts/interfaces/ILendingPool.sol#L134)

	```solidity
	    event SetReserveFeeRate(uint256 indexed reserveId, uint256 feeRate);
	```

- Found in contracts/interfaces/IShadowGaugeV3.sol [Line: 16](contracts/interfaces/IShadowGaugeV3.sol#L16)

	```solidity
	    event NotifyReward(address indexed from, address indexed reward, uint256 amount, uint256 period);
	```

- Found in contracts/interfaces/IShadowGaugeV3.sol [Line: 23](contracts/interfaces/IShadowGaugeV3.sol#L23)

	```solidity
	    event Bribe(address indexed from, address indexed reward, uint256 amount, uint256 period);
	```

- Found in contracts/interfaces/IShadowGaugeV3.sol [Line: 31](contracts/interfaces/IShadowGaugeV3.sol#L31)

	```solidity
	    event ClaimRewards(uint256 period, bytes32 _positionHash, address receiver, address reward, uint256 amount);
	```

- Found in contracts/interfaces/IShadowGaugeV3.sol [Line: 34](contracts/interfaces/IShadowGaugeV3.sol#L34)

	```solidity
	    event RewardAdded(address reward);
	```

- Found in contracts/interfaces/IShadowGaugeV3.sol [Line: 37](contracts/interfaces/IShadowGaugeV3.sol#L37)

	```solidity
	    event RewardRemoved(address reward);
	```

- Found in contracts/interfaces/IShadowNonfungiblePositionManager.sol [Line: 15](contracts/interfaces/IShadowNonfungiblePositionManager.sol#L15)

	```solidity
	    event IncreaseLiquidity(uint256 indexed tokenId, uint128 liquidity, uint256 amount0, uint256 amount1);
	```

- Found in contracts/interfaces/IShadowNonfungiblePositionManager.sol [Line: 21](contracts/interfaces/IShadowNonfungiblePositionManager.sol#L21)

	```solidity
	    event DecreaseLiquidity(uint256 indexed tokenId, uint128 liquidity, uint256 amount0, uint256 amount1);
	```

- Found in contracts/interfaces/IShadowNonfungiblePositionManager.sol [Line: 28](contracts/interfaces/IShadowNonfungiblePositionManager.sol#L28)

	```solidity
	    event Collect(uint256 indexed tokenId, address recipient, uint256 amount0, uint256 amount1);
	```

- Found in contracts/interfaces/IStakingRewards.sol [Line: 7](contracts/interfaces/IStakingRewards.sol#L7)

	```solidity
	    event RewardsSet(address rewardsToken, uint256 start, uint256 end, uint256 total);
	```

- Found in contracts/interfaces/IStakingRewards.sol [Line: 9](contracts/interfaces/IStakingRewards.sol#L9)

	```solidity
	    event Staked(address indexed user, address indexed onBehalfOf, uint256 amount);
	```

- Found in contracts/interfaces/IStakingRewards.sol [Line: 11](contracts/interfaces/IStakingRewards.sol#L11)

	```solidity
	    event Withdraw(address indexed user, address indexed to, uint256 amount);
	```

- Found in contracts/interfaces/IStakingRewards.sol [Line: 13](contracts/interfaces/IStakingRewards.sol#L13)

	```solidity
	    event RewardPaid(address indexed user, address indexed rewardsToken, uint256 claimed);
	```

- Found in contracts/interfaces/ISwapXNonfungiblePositionManager.sol [Line: 19](contracts/interfaces/ISwapXNonfungiblePositionManager.sol#L19)

	```solidity
	    event IncreaseLiquidity(
	```

- Found in contracts/interfaces/ISwapXNonfungiblePositionManager.sol [Line: 34](contracts/interfaces/ISwapXNonfungiblePositionManager.sol#L34)

	```solidity
	    event DecreaseLiquidity(
	```

- Found in contracts/interfaces/ISwapXNonfungiblePositionManager.sol [Line: 42](contracts/interfaces/ISwapXNonfungiblePositionManager.sol#L42)

	```solidity
	    event FeeVaultForPool(address pool, address feeVault, uint16 fee);
	```

- Found in contracts/interfaces/ISwapXNonfungiblePositionManager.sol [Line: 50](contracts/interfaces/ISwapXNonfungiblePositionManager.sol#L50)

	```solidity
	    event Collect(uint256 indexed tokenId, address recipient, uint256 amount0, uint256 amount1);
	```

- Found in contracts/interfaces/ISwapXNonfungiblePositionManager.sol [Line: 59](contracts/interfaces/ISwapXNonfungiblePositionManager.sol#L59)

	```solidity
	    event FarmingCenter(address farmingCenterAddress);
	```

- Found in contracts/interfaces/IVault.sol [Line: 7](contracts/interfaces/IVault.sol#L7)

	```solidity
	    event PositionOpened(
	```

- Found in contracts/interfaces/IVault.sol [Line: 20](contracts/interfaces/IVault.sol#L20)

	```solidity
	    event PositionClosed(
	```

- Found in contracts/interfaces/IVault.sol [Line: 30](contracts/interfaces/IVault.sol#L30)

	```solidity
	    event PositionReduced(
	```

- Found in contracts/interfaces/IVault.sol [Line: 33](contracts/interfaces/IVault.sol#L33)

	```solidity
	    event PositionLiquidated(
	```

- Found in contracts/interfaces/IVault.sol [Line: 46](contracts/interfaces/IVault.sol#L46)

	```solidity
	    event RewardClaimed(
	```

- Found in contracts/interfaces/IVaultFactory.sol [Line: 6](contracts/interfaces/IVaultFactory.sol#L6)

	```solidity
	    event NewVault(address vaultAddress, uint256 indexed vaultId);
	```

- Found in contracts/mock/MockWETH9.sol [Line: 13](contracts/mock/MockWETH9.sol#L13)

	```solidity
	    event Deposit(address indexed dst, uint256 wad);
	```

- Found in contracts/mock/MockWETH9.sol [Line: 14](contracts/mock/MockWETH9.sol#L14)

	```solidity
	    event Withdrawal(address indexed src, uint256 wad);
	```

</details>



## L-8: Empty `require()` / `revert()` statements

Use descriptive reason strings or custom errors for revert paths.

<details><summary>8 Found Instances</summary>


- Found in contracts/IndividualPosition.sol [Line: 18](contracts/IndividualPosition.sol#L18)

	```solidity
	        require(success);
	```

- Found in contracts/IndividualPosition.sol [Line: 24](contracts/IndividualPosition.sol#L24)

	```solidity
	        require(msg.sender == _owner());
	```

- Found in contracts/IndividualPosition.sol [Line: 57](contracts/IndividualPosition.sol#L57)

	```solidity
	        require(impl != address(0));
	```

- Found in contracts/lendingpool/StakingRewards.sol [Line: 42](contracts/lendingpool/StakingRewards.sol#L42)

	```solidity
	        require(lendingPool == msg.sender);
	```

- Found in contracts/libraries/uniswap-v3/FullMath.sol [Line: 31](contracts/libraries/uniswap-v3/FullMath.sol#L31)

	```solidity
	                require(denominator > 0);
	```

- Found in contracts/libraries/uniswap-v3/FullMath.sol [Line: 40](contracts/libraries/uniswap-v3/FullMath.sol#L40)

	```solidity
	            require(denominator > prod1);
	```

- Found in contracts/libraries/uniswap-v3/FullMath.sol [Line: 115](contracts/libraries/uniswap-v3/FullMath.sol#L115)

	```solidity
	                require(result < type(uint256).max);
	```

- Found in contracts/libraries/uniswap-v3/LiquidityAmounts.sol [Line: 14](contracts/libraries/uniswap-v3/LiquidityAmounts.sol#L14)

	```solidity
	        require((y = uint128(x)) == x);
	```

</details>



## L-9: The `nonReentrant` `modifier` should occur before all other modifiers

This is a best-practice to protect against reentrancy in other modifiers.

<details><summary>13 Found Instances</summary>


- Found in contracts/lendingpool/ExtraInterestBearingToken.sol [Line: 47](contracts/lendingpool/ExtraInterestBearingToken.sol#L47)

	```solidity
	    function mint(address user, uint256 amount) external onlyLendingPool nonReentrant {
	```

- Found in contracts/lendingpool/ExtraInterestBearingToken.sol [Line: 64](contracts/lendingpool/ExtraInterestBearingToken.sol#L64)

	```solidity
	        nonReentrant
	```

- Found in contracts/lendingpool/ExtraInterestBearingToken.sol [Line: 78](contracts/lendingpool/ExtraInterestBearingToken.sol#L78)

	```solidity
	    function mintToTreasury(address treasury, uint256 amount) external onlyLendingPool nonReentrant {
	```

- Found in contracts/lendingpool/ExtraInterestBearingToken.sol [Line: 95](contracts/lendingpool/ExtraInterestBearingToken.sol#L95)

	```solidity
	        nonReentrant
	```

- Found in contracts/lendingpool/LendingPool.sol [Line: 108](contracts/lendingpool/LendingPool.sol#L108)

	```solidity
	        nonReentrant
	```

- Found in contracts/lendingpool/LendingPool.sol [Line: 127](contracts/lendingpool/LendingPool.sol#L127)

	```solidity
	        nonReentrant
	```

- Found in contracts/lendingpool/LendingPool.sol [Line: 164](contracts/lendingpool/LendingPool.sol#L164)

	```solidity
	        nonReentrant
	```

- Found in contracts/lendingpool/LendingPool.sol [Line: 189](contracts/lendingpool/LendingPool.sol#L189)

	```solidity
	        nonReentrant
	```

- Found in contracts/lendingpool/LendingPool.sol [Line: 256](contracts/lendingpool/LendingPool.sol#L256)

	```solidity
	    function newDebtPosition(uint256 reserveId) external notPaused nonReentrant returns (uint256 debtId) {
	```

- Found in contracts/lendingpool/LendingPool.sol [Line: 282](contracts/lendingpool/LendingPool.sol#L282)

	```solidity
	    function borrow(address onBehalfOf, uint256 debtId, uint256 amount) external notPaused nonReentrant {
	```

- Found in contracts/lendingpool/LendingPool.sol [Line: 327](contracts/lendingpool/LendingPool.sol#L327)

	```solidity
	        nonReentrant
	```

- Found in contracts/lendingpool/StakingRewards.sol [Line: 99](contracts/lendingpool/StakingRewards.sol#L99)

	```solidity
	        nonReentrant
	```

- Found in contracts/lendingpool/StakingRewards.sol [Line: 182](contracts/lendingpool/StakingRewards.sol#L182)

	```solidity
	        nonReentrant
	```

</details>



## L-10: Modifiers invoked only once can be shoe-horned into the function



<details><summary>3 Found Instances</summary>


- Found in contracts/IndividualPosition.sol [Line: 23](contracts/IndividualPosition.sol#L23)

	```solidity
	    modifier onlyOwner() {
	```

- Found in contracts/lendingpool/StakingRewards.sol [Line: 41](contracts/lendingpool/StakingRewards.sol#L41)

	```solidity
	    modifier onlyLendingPool() {
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 72](contracts/shadow/ShadowRangeVault.sol#L72)

	```solidity
	    modifier checkDeadline(uint256 deadline) {
	```

</details>



## L-11: Empty Block

Consider removing empty blocks.

<details><summary>2 Found Instances</summary>


- Found in contracts/lendingpool/StakingRewards.sol [Line: 207](contracts/lendingpool/StakingRewards.sol#L207)

	```solidity
	    function update() external updateReward(address(0)) onlyOwner {}
	```

- Found in contracts/mock/MockTestBorrowableVault.sol [Line: 19](contracts/mock/MockTestBorrowableVault.sol#L19)

	```solidity
	    function onReceiveRegisterCallback(uint256 vaultId) external {}
	```

</details>



## L-12: Large literal values multiples of 10000 can be replaced with scientific notation

Use `e` notation, for example: `1e18`, instead of its full numeric value.

<details><summary>10 Found Instances</summary>


- Found in contracts/libraries/Constants.sol [Line: 5](contracts/libraries/Constants.sol#L5)

	```solidity
	    uint256 internal constant PERCENT_100 = 10000;
	```

- Found in contracts/shadow/ShadowRangePositionImpl.sol [Line: 212](contracts/shadow/ShadowRangePositionImpl.sol#L212)

	```solidity
	        reduceLiquidity = liquidity * reducePercentage / 10000;
	```

- Found in contracts/shadow/ShadowRangePositionImpl.sol [Line: 282](contracts/shadow/ShadowRangePositionImpl.sol#L282)

	```solidity
	            token0Fees = token0Reduced * vars.liquidationFee / 10000;
	```

- Found in contracts/shadow/ShadowRangePositionImpl.sol [Line: 285](contracts/shadow/ShadowRangePositionImpl.sol#L285)

	```solidity
	            uint256 token0CallerFees = token0Fees * vars.liquidationCallerFee / 10000;
	```

- Found in contracts/shadow/ShadowRangePositionImpl.sol [Line: 294](contracts/shadow/ShadowRangePositionImpl.sol#L294)

	```solidity
	            token1Fees = token1Reduced * vars.liquidationFee / 10000;
	```

- Found in contracts/shadow/ShadowRangePositionImpl.sol [Line: 298](contracts/shadow/ShadowRangePositionImpl.sol#L298)

	```solidity
	            uint256 token1CallerFees = token1Fees * vars.liquidationCallerFee / 10000;
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 297](contracts/shadow/ShadowRangeVault.sol#L297)

	```solidity
	        require(params.reducePercentage > 0 && params.reducePercentage < 10000, "Invalid reduce percentage");
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 384](contracts/shadow/ShadowRangeVault.sol#L384)

	```solidity
	        uint256 feeAmount = amount * performanceFee / 10000;
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 457](contracts/shadow/ShadowRangeVault.sol#L457)

	```solidity
	        return borrowValue * 10000 / (principalValue + borrowValue);
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 461](contracts/shadow/ShadowRangeVault.sol#L461)

	```solidity
	        return getDebtValue(positionId) * 10000 / getPositionValue(positionId);
	```

</details>



## L-13: Internal functions called only once can be inlined

Instead of separating the logic into a separate function, consider inlining the logic into the calling function. This can reduce the number of function calls and improve readability.

<details><summary>8 Found Instances</summary>


- Found in contracts/lendingpool/LendingPool.sol [Line: 362](contracts/lendingpool/LendingPool.sol#L362)

	```solidity
	    function initReserve(
	```

- Found in contracts/lendingpool/LendingPool.sol [Line: 384](contracts/lendingpool/LendingPool.sol#L384)

	```solidity
	    function createStakingPoolForReserve(uint256 reserveId) internal {
	```

- Found in contracts/libraries/logic/InterestRateUtils.sol [Line: 77](contracts/libraries/logic/InterestRateUtils.sol#L77)

	```solidity
	    function calculateCompoundedInterest(uint256 rate, uint128 lastUpdateTimestamp, uint256 currentTimestamp)
	```

- Found in contracts/libraries/logic/ReserveLogic.sol [Line: 39](contracts/libraries/logic/ReserveLogic.sol#L39)

	```solidity
	    function availableLiquidity(DataTypes.ReserveData storage reserve) internal view returns (uint256 liquidity) {
	```

- Found in contracts/libraries/logic/ReserveLogic.sol [Line: 48](contracts/libraries/logic/ReserveLogic.sol#L48)

	```solidity
	    function borrowedLiquidity(DataTypes.ReserveData storage reserve) internal view returns (uint256 liquidity) {
	```

- Found in contracts/libraries/logic/ReserveLogic.sol [Line: 81](contracts/libraries/logic/ReserveLogic.sol#L81)

	```solidity
	    function reserveToETokenExchangeRate(DataTypes.ReserveData storage reserve) internal view returns (uint256) {
	```

- Found in contracts/libraries/uniswap-v3/FullMath.sol [Line: 14](contracts/libraries/uniswap-v3/FullMath.sol#L14)

	```solidity
	    function mulDiv(uint256 a, uint256 b, uint256 denominator) internal pure returns (uint256 result) {
	```

- Found in contracts/libraries/uniswap-v3/TickMath.sol [Line: 26](contracts/libraries/uniswap-v3/TickMath.sol#L26)

	```solidity
	    function getSqrtRatioAtTick(int24 tick) internal pure returns (uint160 sqrtPriceX96) {
	```

</details>



## L-14: Unused Custom Error

it is recommended that the definition be removed when custom error is unused

<details><summary>5 Found Instances</summary>


- Found in contracts/interfaces/IShadowGaugeV3.sol [Line: 5](contracts/interfaces/IShadowGaugeV3.sol#L5)

	```solidity
	    error NOT_AUTHORIZED();
	```

- Found in contracts/interfaces/IShadowGaugeV3.sol [Line: 6](contracts/interfaces/IShadowGaugeV3.sol#L6)

	```solidity
	    error NOT_VOTER();
	```

- Found in contracts/interfaces/IShadowGaugeV3.sol [Line: 7](contracts/interfaces/IShadowGaugeV3.sol#L7)

	```solidity
	    error NOT_GT_ZERO(uint256 amt);
	```

- Found in contracts/interfaces/IShadowGaugeV3.sol [Line: 8](contracts/interfaces/IShadowGaugeV3.sol#L8)

	```solidity
	    error CANT_CLAIM_FUTURE();
	```

- Found in contracts/interfaces/IShadowGaugeV3.sol [Line: 9](contracts/interfaces/IShadowGaugeV3.sol#L9)

	```solidity
	    error RETRO();
	```

</details>



## L-15: Loop contains `require`/`revert` statements

Avoid `require` / `revert` statements in a loop because a single bad item can cause the whole transaction to fail. It's better to forgive on fail and return failed elements post processing of the loop

<details><summary>1 Found Instances</summary>


- Found in contracts/lendingpool/StakingRewards.sol [Line: 196](contracts/lendingpool/StakingRewards.sol#L196)

	```solidity
	        for (uint256 i = 0; i < rewardTokens.length; i++) {
	```

</details>



## L-16: Uninitialized local variables.

Initialize all the variables. If a variable is meant to be initialized to zero, explicitly set it to zero to improve code readability.

<details><summary>1 Found Instances</summary>


- Found in contracts/lendingpool/StakingRewards.sol [Line: 47](contracts/lendingpool/StakingRewards.sol#L47)

	```solidity
	        for (uint256 i; i < rewardTokens.length; i++) {
	```

</details>



## L-17: Dead Code

Functions that are not used. Consider removing them.

<details><summary>1 Found Instances</summary>


- Found in contracts/shadow/ShadowRangePositionImpl.sol [Line: 454](contracts/shadow/ShadowRangePositionImpl.sol#L454)

	```solidity
	    function _swapTokenExactOutput(address tokenIn, address tokenOut, uint256 amountOut, uint256 amountInMaximum)
	```

</details>



## L-18: Loop condition contains `state_variable.length` that could be cached outside.

Cache the lengths of storage arrays if they are used and not modified in for loops.

<details><summary>2 Found Instances</summary>


- Found in contracts/lendingpool/StakingRewards.sol [Line: 47](contracts/lendingpool/StakingRewards.sol#L47)

	```solidity
	        for (uint256 i; i < rewardTokens.length; i++) {
	```

- Found in contracts/lendingpool/StakingRewards.sol [Line: 196](contracts/lendingpool/StakingRewards.sol#L196)

	```solidity
	        for (uint256 i = 0; i < rewardTokens.length; i++) {
	```

</details>



## L-19: Costly operations inside loops.

Invoking `SSTORE`operations in loops may lead to Out-of-gas errors. Use a local variable to hold the loop computation result.

<details><summary>3 Found Instances</summary>


- Found in contracts/PrimaryPriceOracle.sol [Line: 27](contracts/PrimaryPriceOracle.sol#L27)

	```solidity
	        for (uint256 i = 0; i < initialTokens.length; i++) {
	```

- Found in contracts/lendingpool/StakingRewards.sol [Line: 47](contracts/lendingpool/StakingRewards.sol#L47)

	```solidity
	        for (uint256 i; i < rewardTokens.length; i++) {
	```

- Found in contracts/lendingpool/StakingRewards.sol [Line: 196](contracts/lendingpool/StakingRewards.sol#L196)

	```solidity
	        for (uint256 i = 0; i < rewardTokens.length; i++) {
	```

</details>



## L-20: Potentially missing inheritance for contract.

There is an interface / abstract contract that is potentially missing (not included in) the inheritance of this contract.

<details><summary>2 Found Instances</summary>


- Found in contracts/shadow/ShadowPositionValueCalculator.sol [Line: 10](contracts/shadow/ShadowPositionValueCalculator.sol#L10)

	Is this contract supposed to implement an interface? Consider extending one of the following: IPositionValueCalculator
	```solidity
	contract ShadowPositionValueCalculator {
	```

- Found in contracts/swapx/SwapXPositionValueCalculator.sol [Line: 10](contracts/swapx/SwapXPositionValueCalculator.sol#L10)

	Is this contract supposed to implement an interface? Consider extending one of the following: IPositionValueCalculator
	```solidity
	contract SwapXPositionValueCalculator {
	```

</details>



## L-21: Unused Imports

Redundant import statement. Consider removing it.

<details><summary>4 Found Instances</summary>


- Found in contracts/VaultRegistry.sol [Line: 6](contracts/VaultRegistry.sol#L6)

	```solidity
	import "./interfaces/IAddressRegistry.sol";
	```

- Found in contracts/lendingpool/LendingPool.sol [Line: 17](contracts/lendingpool/LendingPool.sol#L17)

	```solidity
	import "../libraries/logic/ReserveKey.sol";
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 12](contracts/shadow/ShadowRangeVault.sol#L12)

	```solidity
	import {IShadowGaugeV3} from "../interfaces/IShadowGaugeV3.sol";
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 20](contracts/shadow/ShadowRangeVault.sol#L20)

	```solidity
	import {IShadowSwapRouter} from "../interfaces/IShadowSwapRouter.sol";
	```

</details>



## L-22: State variable changes but no event is emitted.

State variable changes in this function but no event is emitted.

<details><summary>20 Found Instances</summary>


- Found in contracts/PrimaryPriceOracle.sol [Line: 18](contracts/PrimaryPriceOracle.sol#L18)

	```solidity
	    function initialize(
	```

- Found in contracts/PrimaryPriceOracle.sol [Line: 39](contracts/PrimaryPriceOracle.sol#L39)

	```solidity
	    function setOracleManager(address _oracleManager) external onlyOracleManager {
	```

- Found in contracts/PrimaryPriceOracle.sol [Line: 44](contracts/PrimaryPriceOracle.sol#L44)

	```solidity
	    function setPythPriceId(address token, bytes32 priceId) external onlyOracleManager {
	```

- Found in contracts/PrimaryPriceOracle.sol [Line: 48](contracts/PrimaryPriceOracle.sol#L48)

	```solidity
	    function setMaxPriceAge(uint256 _maxPriceAge) external onlyOracleManager {
	```

- Found in contracts/lendingpool/LendingPool.sol [Line: 57](contracts/lendingpool/LendingPool.sol#L57)

	```solidity
	    function initialize(address _addressRegistry, address _WETH9) public initializer {
	```

- Found in contracts/lendingpool/LendingPool.sol [Line: 256](contracts/lendingpool/LendingPool.sol#L256)

	```solidity
	    function newDebtPosition(uint256 reserveId) external notPaused nonReentrant returns (uint256 debtId) {
	```

- Found in contracts/lendingpool/StakingRewards.sol [Line: 207](contracts/lendingpool/StakingRewards.sol#L207)

	```solidity
	    function update() external updateReward(address(0)) onlyOwner {}
	```

- Found in contracts/shadow/ShadowRangePositionImpl.sol [Line: 41](contracts/shadow/ShadowRangePositionImpl.sol#L41)

	```solidity
	    function initialize(uint256 _positionId) external {
	```

- Found in contracts/shadow/ShadowRangePositionImpl.sol [Line: 83](contracts/shadow/ShadowRangePositionImpl.sol#L83)

	```solidity
	    function openPosition(OpenPositionParams memory params)
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 77](contracts/shadow/ShadowRangeVault.sol#L77)

	```solidity
	    function onReceiveRegisterCallback(uint256 _vaultId) external {
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 83](contracts/shadow/ShadowRangeVault.sol#L83)

	```solidity
	    function initialize(
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 110](contracts/shadow/ShadowRangeVault.sol#L110)

	```solidity
	    function setLiquidator(address _liquidator, bool _isLiquidator) external onlyOwner {
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 114](contracts/shadow/ShadowRangeVault.sol#L114)

	```solidity
	    function setLiquidationFeeParams(uint256 _liquidationFee, uint256 _liquidationCallerFeeRatio) external onlyOwner {
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 119](contracts/shadow/ShadowRangeVault.sol#L119)

	```solidity
	    function setOpenLiquidationEnabled(bool _openLiquidationEnabled) external onlyOwner {
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 123](contracts/shadow/ShadowRangeVault.sol#L123)

	```solidity
	    function setPositionImplementation(address _positionImplementation) external onlyOwner {
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 127](contracts/shadow/ShadowRangeVault.sol#L127)

	```solidity
	    function setLiquidationDebtRatio(uint256 _liquidationDebtRatio) external onlyOwner {
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 131](contracts/shadow/ShadowRangeVault.sol#L131)

	```solidity
	    function setReserveIds(uint256 _token0ReserveId, uint256 _token1ReserveId) external onlyOwner {
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 140](contracts/shadow/ShadowRangeVault.sol#L140)

	```solidity
	    function setMinPositionSize(uint256 _minPositionSize) external onlyOwner {
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 144](contracts/shadow/ShadowRangeVault.sol#L144)

	```solidity
	    function setPerformanceFee(uint256 _performanceFee) external onlyOwner {
	```

- Found in contracts/shadow/ShadowRangeVault.sol [Line: 148](contracts/shadow/ShadowRangeVault.sol#L148)

	```solidity
	    function setShadowGauge(address _shadowGauge) external onlyOwner {
	```

</details>



## L-23: State variable could be declared immutable

State variables that are should be declared immutable to save gas. Add the `immutable` attribute to state variables that are only changed in the constructor

<details><summary>3 Found Instances</summary>


- Found in contracts/lendingpool/ExtraInterestBearingToken.sol [Line: 25](contracts/lendingpool/ExtraInterestBearingToken.sol#L25)

	```solidity
	    uint8 private _decimals;
	```

- Found in contracts/mock/MockTestBorrowableVault.sol [Line: 13](contracts/mock/MockTestBorrowableVault.sol#L13)

	```solidity
	    address lendingPool;
	```

- Found in contracts/viewer/VaultPositionViewer.sol [Line: 32](contracts/viewer/VaultPositionViewer.sol#L32)

	```solidity
	    address addressProvider;
	```

</details>



